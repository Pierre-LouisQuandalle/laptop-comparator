import sharp from 'sharp';
import fs from 'fs/promises';
import path from 'path';
import https from 'https';

const IMAGES_DIR = 'static/images/laptops';

const laptopImages = [
  {
    url: 'https://store.storeimages.cdn-apple.com/4668/as-images.apple.com/is/refurb-mbp16-m2-spacegray-202303?wid=2000&hei=1536&fmt=jpeg&qlt=95&.v=1680103637521',
    filename: 'macbook-pro-m2.webp'
  },
  {
    url: 'data:image/jpeg;base64,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',
    filename: 'dell-xps-13.webp'
  },
  {
    url: 'https://m.media-amazon.com/images/I/71ZQ2AIvBFL.jpg',
    filename: 'lenovo-thinkpad-x1.webp'
  },
  {
    url: 'https://static.fnac-static.com/multimedia/Images/FR/MDM/d3/57/4e/21911507/3756-1/tsp20250103034453/PC-Portable-HP-Envy-16-h1019nf-16-Intel-Evo-Core-i7-16-Go-RAM-1-To-D-Argent-naturel.jpg',
    filename: 'hp-envy-x360.webp'
  },
  {
    url: 'https://dlcdnwebimgs.asus.com/gain/6A42560A-BF3E-4940-9AE6-DF6D3794C70A',
    filename: 'asus-rog-zephyrus.webp'
  },
  {
    url: 'https://store.storeimages.cdn-apple.com/4668/as-images.apple.com/is/macbook-air-midnight-select-20220606',
    filename: 'macbook-air-m2.webp'
  },
  {
    url: 'https://i.dell.com/is/image/DellContent/content/dam/ss2/product-images/dell-client-products/notebooks/inspiron-notebooks/15-3520/media-gallery/in3520-xnb-01-sl',
    filename: 'dell-inspiron-15.webp'
  },
  {
    url: 'https://m.media-amazon.com/images/I/81SfCsvmrZL.jpg',
    filename: 'lenovo-legion-5.webp'
  },
  {
    url: 'https://m.media-amazon.com/images/I/81WRiMUm9+L.jpg',
    filename: 'hp-spectre-x360.webp'
  },
  {
    url: 'https://media.ldlc.com/r1600/ld/products/00/06/18/97/LD0006189712.jpg',
    filename: 'asus-zenbook-14.webp'
  }
];

async function downloadImage(url: string): Promise<Buffer> {
  return new Promise((resolve, reject) => {
    https.get(url, (response) => {
      const chunks: Buffer[] = [];
      response.on('data', (chunk) => chunks.push(chunk));
      response.on('end', () => resolve(Buffer.concat(chunks)));
      response.on('error', reject);
    }).on('error', reject);
  });
}

async function optimizeAndSaveImage(buffer: Buffer, filename: string) {
  await sharp(buffer)
    .resize(500, 300, { fit: 'cover' })
    .webp({ quality: 80 })
    .toFile(path.join(IMAGES_DIR, filename));
}

async function main() {
  // Créer le dossier s'il n'existe pas
  await fs.mkdir(IMAGES_DIR, { recursive: true });

  for (const image of laptopImages) {
    try {
      console.log(`Téléchargement de ${image.filename}...`);
      const buffer = await downloadImage(image.url);
      
      console.log(`Optimisation de ${image.filename}...`);
      await optimizeAndSaveImage(buffer, image.filename);
      
      console.log(`✅ ${image.filename} traité avec succès`);
    } catch (error) {
      console.error(`❌ Erreur avec ${image.filename}:`, error);
    }
  }
}

main().catch(console.error);